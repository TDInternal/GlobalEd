<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra Dotta: Solution Finder</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Custom Tailwind Config for Brand Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'td-blue': '#00aeef',
                        'td-green': '#8dc73f',
                        'td-orange': '#f57922',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Apply the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa; /* Light gray background for contrast */
        }
        
        /* Transition for showing/hiding steps */
        .wizard-step {
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            will-change: opacity, transform;
        }

        .wizard-step.hidden {
            opacity: 0;
            transform: translateY(20px);
            position: absolute;
            pointer-events: none;
        }

        /* Custom Checkbox Styling */
        .custom-checkbox:checked {
            background-color: #00aeef;
            border-color: #00aeef;
        }
        .custom-checkbox:checked + label {
            color: #00aeef;
            font-weight: 600;
        }
        label {
            transition: color 0.2s;
        }

        .card-hover {
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.08);
        }
        
        /* Custom list style for benefits */
        .benefits-list li {
            position: relative;
            padding-left: 28px; /* Space for the icon */
            margin-bottom: 8px;
        }
        .benefits-list li::before {
            content: '✔';
            position: absolute;
            left: 0;
            top: 1px;
            color: #8dc73f; /* td-green */
            font-weight: bold;
            font-size: 18px;
        }
    </style>
</head>
<body class="text-slate-700">
    <!-- Header Banner -->
    <header class="bg-td-blue text-white text-center py-12 sm:py-16">
        <div class="max-w-5xl mx-auto px-4">
            <h1 class="text-4xl sm:text-5xl font-extrabold mb-4">Find Your Solution</h1>
            <p class="text-lg sm:text-xl text-blue-100 max-w-3xl mx-auto">
                Answer a few questions about your institution's needs, and we'll recommend the right solutions to help you build a more connected campus.
            </p>
        </div>
    </header>

    <main class="max-w-5xl mx-auto p-4 sm:p-8 -mt-20">
        <div id="solutionFinder" class="bg-white p-6 sm:p-10 rounded-2xl shadow-lg relative min-h-[500px]">
            
            <!-- Step 1: Current Solutions -->
            <div id="step1" class="wizard-step">
                <h2 class="text-2xl sm:text-3xl font-bold text-slate-800 mb-2">Step 1: What You Have</h2>
                <p class="text-slate-500 mb-8">Select the Terra Dotta solutions you currently use. This will help us suggest what's next.</p>
                <div id="currentSolutions" class="space-y-4">
                    <!-- Options will be populated by JS -->
                </div>
                <div class="mt-10 text-right">
                    <button onclick="goToStep(2)" class="bg-td-blue hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-all">Next &rarr;</button>
                </div>
            </div>

            <!-- Step 2: Challenges -->
            <div id="step2" class="wizard-step hidden">
                <h2 class="text-2xl sm:text-3xl font-bold text-slate-800 mb-2">Step 2: Your Challenges</h2>
                <p class="text-slate-500 mb-8">What are the biggest challenges your office is facing right now? Select all that apply.</p>
                <div id="challenges" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                    <!-- Options will be populated by JS -->
                </div>
                <div class="mt-10 flex justify-between">
                    <button onclick="goToStep(1)" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-3 px-8 rounded-lg transition-all">&larr; Back</button>
                    <button onclick="showResults()" class="bg-td-green hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-all">See My Recommendations</button>
                </div>
            </div>
            
            <!-- Step 3: Results -->
            <div id="step3" class="wizard-step hidden">
                <h2 class="text-3xl font-bold text-slate-800 mb-8 text-center">Your Connected Campus Journey</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                    <div>
                        <h3 class="font-bold text-xl text-slate-700 mb-4 text-center">Your Current Ecosystem</h3>
                        <div id="currentResults" class="space-y-4">
                           <!-- Current solutions will be populated here -->
                        </div>
                    </div>
                    <div>
                        <h3 class="font-bold text-xl text-td-green mb-4 text-center">Your Recommended Additions</h3>
                         <div id="recommendedResults" class="space-y-4">
                           <!-- Recommended solutions will be populated here -->
                        </div>
                    </div>
                </div>

                <hr class="my-10 border-slate-200">

                <div>
                    <h3 class="font-bold text-2xl text-slate-800 mb-6 text-center">Now you will be able to...</h3>
                    <ul id="benefits" class="benefits-list text-slate-600 max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2">
                        <!-- Combined benefits will be populated here -->
                    </ul>
                </div>
                
                <div class="mt-12 text-center space-y-4 sm:space-y-0 sm:space-x-4">
                    <button onclick="resetFinder()" class="w-full sm:w-auto bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-3 px-8 rounded-lg transition-all">Start Over</button>
                    <a href="https://www.terradotta.com/request-demo.html" target="_blank" class="w-full sm:w-auto inline-block bg-td-green hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-all">Let's start the conversation!</a>
                </div>
            </div>

        </div>
    </main>

    <script>
        // --- DATA ---
        // Comprehensive data for all solutions
        const solutions = {
            'Study Abroad': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9V3m0 18a9 9 0 009-9M3 12a9 9 0 019-9m0 18a9 9 0 00-9-9m9 9H3" />',
                description: 'Enhance the applicant experience with a searchable program catalog and seamless online applications.',
                solves: 'Streamline the entire outbound mobility lifecycle into one manageable hub.',
                color: 'text-td-blue'
            },
            'ISSS': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" />',
                description: 'Centralize academic, biographic, and SEVIS data to maintain compliance.',
                solves: 'Reduce administrative burden and SEVIS risk to improve international student yield.',
                color: 'text-td-blue'
            },
            'AlertTraveler®': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />',
                description: 'Provide a mobile safety net with real-time country intelligence and proactive emergency alerts.',
                solves: 'Fulfill Duty of Care with a vital safety tool for instant check-ins and help requests.',
                color: 'text-td-orange'
            },
            'Travel Registry': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />',
                description: 'Organize information for all university travel—including faculty, staff, and students on non-credit trips.',
                solves: 'Mitigate institutional risk and streamline reporting for compliance policies like NSPM-33.',
                color: 'text-td-orange'
            },
            'Agreements Management': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />',
                description: 'Capture agreement details via an online proposal system and manage partnership lifecycles.',
                solves: 'Visualize your global footprint and ensure partnership equity by tracking exchange balances.',
                color: 'text-td-green'
            },
            'Engage': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-2.236 9.168-5.514C18.358 1.84 18.668 1.5 19 1.5s.642.34 1.001.986C21.375 5.236 22.91 9.9 21.832 14h-1.258a4.5 4.5 0 01-4.256-3h-.17a4.5 4.5 0 01-4.256 3H5.436z" />',
                description: 'Connect with students early, match them to programs, and manage events like info sessions.',
                solves: 'Manage the full student journey to increase program pipeline and participation.',
                color: 'text-td-green'
            },
            'Payment Gateway': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />',
                description: 'Integrate a secure, reliable payment processing system into your Terra Dotta site.',
                solves: 'Simplify and secure the collection of application fees and program deposits.',
                color: 'text-td-orange'
            },
            'Dashboards': {
                icon: '<path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />',
                description: 'Leverage data across your solutions to track trends in enrollment, diversity, risk, and more.',
                solves: 'Transform raw data into visual reports to demonstrate ROI and inform strategy.',
                color: 'text-td-green'
            }
        };

        // Challenges and the solutions they map to
        const challenges = [
            { id: 'challenge1', text: 'Managing complex SEVIS compliance for your international students?', recommends: ['ISSS'] },
            { id: 'challenge2', text: 'Struggling to collect fees from applicants worldwide?', recommends: ['Payment Gateway'] },
            { id: 'challenge3', text: 'Worried about how to provide a mobile safety net for your travelers?', recommends: ['AlertTraveler®'] },
            { id: 'challenge4', text: 'Need a reliable way to track all university travel for risk and compliance?', recommends: ['Travel Registry'] },
            { id: 'challenge5', text: 'Losing potential study abroad students from a disjointed engagement process?', recommends: ['Engage'] },
            { id: 'challenge6', text: 'Having trouble managing the lifecycle of your global partnerships?', recommends: ['Agreements Management'] },
            { id: 'challenge7', text: 'Struggling to create and share reports from your data to gain actionable insights?', recommends: ['Dashboards'] }
        ];

        // --- DOM ELEMENTS ---
        const currentSolutionsContainer = document.getElementById('currentSolutions');
        const challengesContainer = document.getElementById('challenges');
        const currentResultsContainer = document.getElementById('currentResults');
        const recommendedResultsContainer = document.getElementById('recommendedResults');
        const benefitsContainer = document.getElementById('benefits');


        // --- LOGIC ---
        let currentStep = 1;

        // Function to create a checkbox item
        function createCheckbox(id, name, value, labelText) {
            // **CSS FIX**: Use "items-start" to align checkboxes to the top. Removed mt-1 for more consistent alignment.
            return `
                <div class="flex items-start">
                    <input id="${id}" name="${name}" type="checkbox" value="${value}" class="custom-checkbox h-5 w-5 rounded border-gray-300 text-td-blue focus:ring-td-blue flex-shrink-0 mt-1">
                    <label for="${id}" class="ml-3 text-md text-slate-600">${labelText}</label>
                </div>
            `;
        }

        // Function to create a solution card for the results page
        function createSolutionCard(key, isFaded = false) {
            const solution = solutions[key];
            if (!solution) return '';
            
            const opacityClass = isFaded ? 'opacity-60' : '';

            return `
                <div class="bg-white p-4 rounded-xl border border-slate-200 flex flex-col ${opacityClass}">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 bg-slate-100 ${solution.color} rounded-lg p-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">${solution.icon}</svg>
                        </div>
                        <h4 class="font-bold text-md ml-3 text-slate-800">${key}</h4>
                    </div>
                    <p class="text-slate-500 text-sm mt-2 flex-grow">${solution.description}</p>
                </div>
            `;
        }
        
        // Populate Step 1: Current Solutions
        Object.keys(solutions).forEach(key => {
            const id = `current_${key.replace(/[^a-zA-Z0-9]/g, '')}`;
            currentSolutionsContainer.innerHTML += createCheckbox(id, 'currentSolutions', key, key);
        });
        
        // Populate Step 2: Challenges
        challenges.forEach(challenge => {
            challengesContainer.innerHTML += createCheckbox(challenge.id, 'challenges', challenge.id, challenge.text);
        });

        // **NEW FUNCTION**: Filters challenges on Step 2 based on selections in Step 1
        function filterChallenges() {
            // Get currently owned solutions
            const ownedSolutions = Array.from(document.querySelectorAll('input[name="currentSolutions"]:checked')).map(cb => cb.value);

            // Create a set of challenge IDs that should be hidden
            const challengesToHide = new Set();
            challenges.forEach(challenge => {
                const shouldHide = challenge.recommends.some(rec => ownedSolutions.includes(rec));
                if (shouldHide) {
                    challengesToHide.add(challenge.id);
                }
            });

            // Loop through the challenge checkboxes in the DOM and show/hide them
            challenges.forEach(challenge => {
                // The checkbox's parent div holds the whole row
                const challengeElement = document.getElementById(challenge.id).parentElement;
                if (challengeElement) {
                    if (challengesToHide.has(challenge.id)) {
                        challengeElement.classList.add('hidden');
                    } else {
                        challengeElement.classList.remove('hidden');
                    }
                }
            });
        }


        // Navigate between steps
        function goToStep(stepNumber) {
            // **LOGIC UPDATE**: When moving to Step 2, run the filter function first.
            if (stepNumber === 2) {
                filterChallenges();
            }

            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${stepNumber}`).classList.remove('hidden');
            currentStep = stepNumber;
        }

        // Calculate and display recommendations
        function showResults() {
            // Get selected current solutions
            const ownedSolutions = Array.from(document.querySelectorAll('input[name="currentSolutions"]:checked')).map(cb => cb.value);
            
            // Get selected challenges
            const selectedChallenges = Array.from(document.querySelectorAll('input[name="challenges"]:checked')).map(cb => cb.value);

            // Determine recommended solutions based on challenges
            let recommendations = new Set();
            selectedChallenges.forEach(challengeId => {
                const challenge = challenges.find(c => c.id === challengeId);
                if (challenge) {
                    challenge.recommends.forEach(rec => recommendations.add(rec));
                }
            });

            // Filter out solutions the user already has
            const finalRecommendations = [...recommendations].filter(rec => !ownedSolutions.includes(rec));
            
            // --- POPULATE RESULTS PAGE ---

            // 1. Populate "Current Ecosystem" column
            currentResultsContainer.innerHTML = '';
            if (ownedSolutions.length > 0) {
                ownedSolutions.forEach(key => {
                    currentResultsContainer.innerHTML += createSolutionCard(key, true);
                });
            } else {
                 currentResultsContainer.innerHTML = `<p class="text-slate-500 text-center p-8 border-2 border-dashed rounded-lg">You didn't select any current solutions.</p>`;
            }


            // 2. Populate "Recommended Additions" column
            recommendedResultsContainer.innerHTML = '';
            if (finalRecommendations.length > 0) {
                 finalRecommendations.forEach(key => {
                    recommendedResultsContainer.innerHTML += createSolutionCard(key);
                });
            } else if (selectedChallenges.length > 0) {
                 recommendedResultsContainer.innerHTML = `<div class="text-center p-8 border-2 border-dashed border-td-green rounded-lg bg-green-50">
                    <h4 class="font-bold text-td-green mb-2">You're Covered!</h4>
                    <p class="text-slate-600">Based on the challenges you selected, your current solutions already have you covered.</p>
                 </div>`;
            } else {
                recommendedResultsContainer.innerHTML = `<p class="text-slate-500 text-center p-8 border-2 border-dashed rounded-lg">Select a challenge in Step 2 to see recommendations.</p>`;
            }

            // 3. Populate "Now you can..." section
            benefitsContainer.innerHTML = '';
            const allBenefits = new Set();
            const allSolutions = [...ownedSolutions, ...finalRecommendations];
            allSolutions.forEach(key => {
                if(solutions[key] && solutions[key].solves) {
                    allBenefits.add(solutions[key].solves);
                }
            });

            if (allBenefits.size > 0) {
                allBenefits.forEach(benefit => {
                    benefitsContainer.innerHTML += `<li>${benefit}</li>`;
                });
            } else {
                 benefitsContainer.innerHTML = `<p class="text-slate-500 text-center col-span-full">Your benefits will appear here once you select solutions and challenges.</p>`;
            }


            goToStep(3);
        }
        
        // Reset the entire finder
        function resetFinder() {
            // Uncheck all boxes
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            // Go back to the first step
            goToStep(1);
        }

    </script>
</body>
</html>
